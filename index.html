<!DOCTYPE html>
<html>
<head>
    <title>Google Maps with Advanced Features</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        #map {
            height: 100vh;
            width: 100vw;
        }
        /* Custom buttons on the bottom right corner */
        .custom-button {
            position: absolute;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background-color: black;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 50px;
            cursor: pointer;
            margin: 5px;
            font-size: 20px;
        }
        #navButton {
            background-color: green;
        }
        #compassButton {
            background-color: blue;
        }

        /* Disable scrolling borders */
        body, html {
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
    </style>
</head>
<body>

<div id="map"></div>
<div id="navButton" class="custom-button">üîç</div>
<div id="compassButton" class="custom-button">üß≠</div>

<script>
    // Initialize and add the map
    function initMap() {
        // Center of the map (Amsterdam coordinates)
        const amsterdam = { lat: 52.370216, lng: 4.895168 };

        // Initialize the map with zoom control
        const map = new google.maps.Map(document.getElementById("map"), {
            zoom: 12, // Default zoom
            center: amsterdam, // Center at Amsterdam
            mapTypeId: 'roadmap', // Map type
            minZoom: 8, // Minimum zoom level
            maxZoom: 18 // Maximum zoom level
        });

        // Define markers and add them to the map
        const markers = [
            { position: { lat: 52.379189, lng: 4.899431 }, name: "Marker 1" },
            { position: { lat: 52.370216, lng: 4.895168 }, name: "Marker 2" },
            { position: { lat: 52.363151, lng: 4.911253 }, name: "Marker 3" }
        ];

        markers.forEach(markerData => {
            const marker = new google.maps.Marker({
                position: markerData.position,
                map: map,
                title: markerData.name
            });

            // Add popup info window for each marker
            const infoWindow = new google.maps.InfoWindow({
                content: `<b>${markerData.name}</b><br>Lat: ${markerData.position.lat}, Lng: ${markerData.position.lng}`
            });

            // Add click event to display info window
            marker.addListener("click", () => {
                infoWindow.open(map, marker);
            });
        });

        // Draw geofence (safe zone) as a circle
        const safeZone = new google.maps.Circle({
            strokeColor: '#00FF00',
            strokeOpacity: 0.8,
            strokeWeight: 2,
            fillColor: '#00FF00',
            fillOpacity: 0.35,
            map: map,
            center: amsterdam,
            radius: 500 // Radius in meters
        });

        // Draw route history using polylines (route that a marker has traveled)
        const routePath = new google.maps.Polyline({
            path: [
                { lat: 52.370216, lng: 4.895168 },
                { lat: 52.372789, lng: 4.892855 },
                { lat: 52.374592, lng: 4.889204 },
                { lat: 52.377936, lng: 4.889492 }
            ],
            geodesic: true,
            strokeColor: '#0000FF',
            strokeOpacity: 1.0,
            strokeWeight: 2
        });

        routePath.setMap(map);

        // Add custom button actions for navigation and compass
        document.getElementById('navButton').addEventListener('click', function() {
            alert("Navigation button clicked! You can trigger a FlutterFlow action here.");
        });

        document.getElementById('compassButton').addEventListener('click', function() {
            alert("Compass button clicked! You can trigger a FlutterFlow action here.");
        });
    }
</script>

<!-- Load Google Maps API using the API key you provided -->
<script async defer
src="https://maps.googleapis.com/maps/api/js?key=AlzaSyAXaZv6geLSLRcWr_qwJD6kHXKVnug_1FE&callback=initMap">
</script>

</body>
</html>
